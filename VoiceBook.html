<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>مكتبة الكتب الصوتية</title>
  <link rel="stylesheet" href="style.css">
</head>

<body>
  <div class="container">

    <img src="VoiceBook.png" alt="صورة" class="logo">

    <h1>مكتبة الكتب الصوتية</h1>
    <h2>اختر أحد الكتب</h2>

    <!-- الكتب ستُضاف هنا تلقائيًا -->
    <div id="books"></div>

  </div>

<script>
const sheetUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-1vTi8zqn1us53rSDKQXYudQWh5BHNpDVJAeAK30UFhP48_MBwrXlHKoM9yevR-TUe843ZPBIVJHV_Y2m/pub?gid=0&single=true&output=csv";

fetch(sheetUrl)
  .then(res => res.text())
  .then(csv => {
    const lines = csv.trim().split("\n");

    // تنظيف أسماء الأعمدة (إزالة BOM والمسافات)
    const headers = lines[0]
      .replace(/\uFEFF/g, "")
      .split(",")
      .map(h => h.trim());

    const rows = lines.slice(1);

    // نضيف index لكل عمود بما فيهم ID الجديد
    const colIndex = {
      ID: headers.indexOf("ID"),         
      book: headers.indexOf("book"),
      sheikh: headers.indexOf("sheikh"),
      count: headers.indexOf("count")
    };

    const container = document.getElementById("books");

    rows.forEach(line => {
      if (!line.trim()) return;

      const cols = line.split(",");

      const ID     = cols[colIndex.ID];    
      const book   = cols[colIndex.book];
      const sheikh = cols[colIndex.sheikh];
      const count  = cols[colIndex.count];

      const link = document.createElement("a");
      link.className = "book";

      // الرابط الآن يمرر ID للصفحة القادمة
      link.href = `Lectures.html?book=${ID}`;

      // نخزن الرقم التعريفي كخاصية data-id
      link.setAttribute("data-id", ID);

      link.innerHTML = `
        <div class="book-title">شرح كتاب ${book}</div>
        <div class="book-desc">${count} محاضرة صوتية للشيخ ${sheikh}</div>
      `;

      container.appendChild(link);
    });
  })
  .catch(err => console.error(err));
</script>
</body>
</html>

